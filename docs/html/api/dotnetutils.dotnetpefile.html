<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>dotnetutils.dotnetpefile module &#8212; dotnetutils  documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=5ecbeea2" />
    <link rel="stylesheet" type="text/css" href="../_static/basic.css?v=b08954a9" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css?v=27fed22d" />
    <script src="../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="dotnetutils.net_cil_disas module" href="dotnetutils.net_cil_disas.html" />
    <link rel="prev" title="dotnetutils package" href="dotnetutils.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="module-dotnetutils.dotnetpefile">
<span id="dotnetutils-dotnetpefile-module"></span><h1>dotnetutils.dotnetpefile module<a class="headerlink" href="#module-dotnetutils.dotnetpefile" title="Link to this heading">¶</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="dotnetutils.dotnetpefile.DotNetPeFile">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">DotNetPeFile</span></span><a class="headerlink" href="#dotnetutils.dotnetpefile.DotNetPeFile" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Represents a DotNetPeFile.  Contains all methods used to access other parts of the .NET metadata structure.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="dotnetutils.dotnetpefile.DotNetPeFile.file_path">
<span class="sig-name descname"><span class="pre">file_path</span></span><a class="headerlink" href="#dotnetutils.dotnetpefile.DotNetPeFile.file_path" title="Link to this definition">¶</a></dt>
<dd><p>The file path of the executable, if set.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dotnetutils.dotnetpefile.DotNetPeFile.exe_data">
<span class="sig-name descname"><span class="pre">exe_data</span></span><a class="headerlink" href="#dotnetutils.dotnetpefile.DotNetPeFile.exe_data" title="Link to this definition">¶</a></dt>
<dd><p>A byte representation of the current exe data.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bytes</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dotnetutils.dotnetpefile.DotNetPeFile.pe">
<span class="sig-name descname"><span class="pre">pe</span></span><a class="headerlink" href="#dotnetutils.dotnetpefile.DotNetPeFile.pe" title="Link to this definition">¶</a></dt>
<dd><p>A PeFile object representing the executable.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#dotnetutils.dotnetpefile.PeFile" title="dotnetutils.dotnetpefile.PeFile">PeFile</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dotnetutils.dotnetpefile.DotNetPeFile.__cor_header_offset">
<span class="sig-name descname"><span class="pre">__cor_header_offset</span></span><a class="headerlink" href="#dotnetutils.dotnetpefile.DotNetPeFile.__cor_header_offset" title="Link to this definition">¶</a></dt>
<dd><p>The offset of the IMAGE_COR20_HEADER</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>uint64_t</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dotnetutils.dotnetpefile.DotNetPeFile.metadata_dir">
<span class="sig-name descname"><span class="pre">metadata_dir</span></span><a class="headerlink" href="#dotnetutils.dotnetpefile.DotNetPeFile.metadata_dir" title="Link to this definition">¶</a></dt>
<dd><p>A metadata directory object representing the executable’s Metadata.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>MetadataDirectory</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dotnetutils.dotnetpefile.DotNetPeFile.original_exe_data">
<span class="sig-name descname"><span class="pre">original_exe_data</span></span><a class="headerlink" href="#dotnetutils.dotnetpefile.DotNetPeFile.original_exe_data" title="Link to this definition">¶</a></dt>
<dd><p>A holder for the unmodified exe data.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bytes</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dotnetutils.dotnetpefile.DotNetPeFile.__versioninfo_str">
<span class="sig-name descname"><span class="pre">__versioninfo_str</span></span><a class="headerlink" href="#dotnetutils.dotnetpefile.DotNetPeFile.__versioninfo_str" title="Link to this definition">¶</a></dt>
<dd><p>Used to hold the version info string obtained by DotNetPeFile.get_product_version().</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dotnetutils.dotnetpefile.DotNetPeFile.add_string">
<span class="sig-name descname"><span class="pre">add_string</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">string</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dotnetutils.dotnetpefile.DotNetPeFile.add_string" title="Link to this definition">¶</a></dt>
<dd><p>Appends a string onto the executable’s Strings heap.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>string</strong> (<em>str</em>) – The string to add.  Must be able to be encoded in UTF-8.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dotnetutils.dotnetpefile.DotNetPeFile.delete_user_string">
<span class="sig-name descname"><span class="pre">delete_user_string</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">us_index</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dotnetutils.dotnetpefile.DotNetPeFile.delete_user_string" title="Link to this definition">¶</a></dt>
<dd><p>Deletes a user string at us_index</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>us_index</strong> (<em>unsigned int</em>) – The #US index to delete.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The difference in size of the #US heap once us_index is deleted.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dotnetutils.dotnetpefile.DotNetPeFile.find_methods_by_regex">
<span class="sig-name descname"><span class="pre">find_methods_by_regex</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">regex</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dotnetutils.dotnetpefile.DotNetPeFile.find_methods_by_regex" title="Link to this definition">¶</a></dt>
<dd><p>Obtains a list of methods matching a provided regex pattern.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>regex</strong> (<em>re.Pattern</em>) – The regex pattern to match</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list containing all MethodDef objects that match regex.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list[<a class="reference internal" href="dotnetutils.net_row_objects.html#dotnetutils.net_row_objects.MethodDef" title="dotnetutils.net_row_objects.MethodDef">net_row_objects.MethodDef</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dotnetutils.dotnetpefile.DotNetPeFile.get_cor20_header">
<span class="sig-name descname"><span class="pre">get_cor20_header</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#dotnetutils.dotnetpefile.DotNetPeFile.get_cor20_header" title="Link to this definition">¶</a></dt>
<dd><p>Obtain the IMAGE_COR20_HEADER structure.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The IMAGE_COR20_HEADER structure for the executable.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>IMAGE_COR20_HEADER</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dotnetutils.dotnetpefile.DotNetPeFile.get_cor_header_offset">
<span class="sig-name descname"><span class="pre">get_cor_header_offset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#dotnetutils.dotnetpefile.DotNetPeFile.get_cor_header_offset" title="Link to this definition">¶</a></dt>
<dd><p>Obtain the file offset of the IMAGE_COR20_HEADER structure.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The offset of the IMAGE_COR20_HEADER structure.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>uint64_t</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dotnetutils.dotnetpefile.DotNetPeFile.get_entry_point">
<span class="sig-name descname"><span class="pre">get_entry_point</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#dotnetutils.dotnetpefile.DotNetPeFile.get_entry_point" title="Link to this definition">¶</a></dt>
<dd><p>Obtains a MethodDef representing the managed entrypoint of the executable.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A MethodDef object representing the executable’s entry point, or None if it doesnt exist.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="dotnetutils.net_row_objects.html#dotnetutils.net_row_objects.MethodDef" title="dotnetutils.net_row_objects.MethodDef">net_row_objects.MethodDef</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dotnetutils.dotnetpefile.DotNetPeFile.get_exe_data">
<span class="sig-name descname"><span class="pre">get_exe_data</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#dotnetutils.dotnetpefile.DotNetPeFile.get_exe_data" title="Link to this definition">¶</a></dt>
<dd><p>Obtain the current exe’s data.  You should call DotNetPeFile.reconstruct_executable() in most cases before calling this.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The current exe’s data, including any patched bytes strings etc.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>bytes</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dotnetutils.dotnetpefile.DotNetPeFile.get_exported_types">
<span class="sig-name descname"><span class="pre">get_exported_types</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#dotnetutils.dotnetpefile.DotNetPeFile.get_exported_types" title="Link to this definition">¶</a></dt>
<dd><p>Obtains a list of all exported TypeDefs in the assembly.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A list containing python representations of all exported TypeDefs in the assembly.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>list[<a class="reference internal" href="dotnetutils.net_row_objects.html#dotnetutils.net_row_objects.TypeDef" title="dotnetutils.net_row_objects.TypeDef">net_row_objects.TypeDef</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dotnetutils.dotnetpefile.DotNetPeFile.get_heap">
<span class="sig-name descname"><span class="pre">get_heap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dotnetutils.dotnetpefile.DotNetPeFile.get_heap" title="Link to this definition">¶</a></dt>
<dd><p>Obtains a HeapObject representing a parsed heap within the .NET metadata directory.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>name</strong> (<em>str</em>) – The name of the heap to obtain.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a HeapObject corresponding to name, None if it doesnt exist.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="dotnetutils.net_processing.html#dotnetutils.net_processing.HeapObject" title="dotnetutils.net_processing.HeapObject">net_processing.HeapObject</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dotnetutils.dotnetpefile.DotNetPeFile.get_heaps">
<span class="sig-name descname"><span class="pre">get_heaps</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#dotnetutils.dotnetpefile.DotNetPeFile.get_heaps" title="Link to this definition">¶</a></dt>
<dd><p>Obtains a dictionary representing all heaps in the executable.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A dict containing all the heaps in the executable, keyed by name.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>dict[str, <a class="reference internal" href="dotnetutils.net_processing.html#dotnetutils.net_processing.HeapObject" title="dotnetutils.net_processing.HeapObject">net_processing.HeapObject</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dotnetutils.dotnetpefile.DotNetPeFile.get_metadata_dir">
<span class="sig-name descname"><span class="pre">get_metadata_dir</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#dotnetutils.dotnetpefile.DotNetPeFile.get_metadata_dir" title="Link to this definition">¶</a></dt>
<dd><p>Obtain the metadata directory.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The metadata directory object for the executable.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>net_metadata.MetadataDirectory</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dotnetutils.dotnetpefile.DotNetPeFile.get_metadata_table">
<span class="sig-name descname"><span class="pre">get_metadata_table</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dotnetutils.dotnetpefile.DotNetPeFile.get_metadata_table" title="Link to this definition">¶</a></dt>
<dd><p>Obtains a TableObject corresponding to name which represents a single metadata Table.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>name</strong> (<em>str</em>) – The name of the table to obtain.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The metadata table object corresponding to name, None if it doesnt exist.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="dotnetutils.net_table_objects.html#dotnetutils.net_table_objects.TableObject" title="dotnetutils.net_table_objects.TableObject">net_table_objects.TableObject</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dotnetutils.dotnetpefile.DotNetPeFile.get_method_by_rid">
<span class="sig-name descname"><span class="pre">get_method_by_rid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rid</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dotnetutils.dotnetpefile.DotNetPeFile.get_method_by_rid" title="Link to this definition">¶</a></dt>
<dd><p>Obtains a MethodDef matching a particular RID.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>rid</strong> (<em>int</em>) – The Method RID to obtain.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the MethodDef object representing the Method at table RID rid.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="dotnetutils.net_row_objects.html#dotnetutils.net_row_objects.MethodDef" title="dotnetutils.net_row_objects.MethodDef">MethodDef</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dotnetutils.dotnetpefile.DotNetPeFile.get_methods_by_full_name">
<span class="sig-name descname"><span class="pre">get_methods_by_full_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">full_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dotnetutils.dotnetpefile.DotNetPeFile.get_methods_by_full_name" title="Link to this definition">¶</a></dt>
<dd><p>Obtains a list of MethodDef objects matching a provided full name. The full name must include the namespace.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>full_name</strong> (<em>bytes</em>) – The full name, including namespace, of the method(s) to search for.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a list of MethodDefOrRef objects corresponding to full_name.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list[<a class="reference internal" href="dotnetutils.net_row_objects.html#dotnetutils.net_row_objects.MethodDefOrRef" title="dotnetutils.net_row_objects.MethodDefOrRef">MethodDefOrRef</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dotnetutils.dotnetpefile.DotNetPeFile.get_methods_by_name">
<span class="sig-name descname"><span class="pre">get_methods_by_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dotnetutils.dotnetpefile.DotNetPeFile.get_methods_by_name" title="Link to this definition">¶</a></dt>
<dd><p>Obtains a list of MethodDef objects matching a provided name.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>name</strong> (<em>bytes</em>) – The name of the method(s) to search for.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a list of MethodDef objects corresponding to name</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list[<a class="reference internal" href="dotnetutils.net_row_objects.html#dotnetutils.net_row_objects.MethodDef" title="dotnetutils.net_row_objects.MethodDef">MethodDef</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dotnetutils.dotnetpefile.DotNetPeFile.get_original_exe_data">
<span class="sig-name descname"><span class="pre">get_original_exe_data</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#dotnetutils.dotnetpefile.DotNetPeFile.get_original_exe_data" title="Link to this definition">¶</a></dt>
<dd><p>Obtain the original exe’s data before any patching etc.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The original data representing the PE file.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>bytes</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dotnetutils.dotnetpefile.DotNetPeFile.get_pe">
<span class="sig-name descname"><span class="pre">get_pe</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#dotnetutils.dotnetpefile.DotNetPeFile.get_pe" title="Link to this definition">¶</a></dt>
<dd><p>Obtain an object representing the current exe’s PeFile structure.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A PeFile object representing the current executable.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#dotnetutils.dotnetpefile.PeFile" title="dotnetutils.dotnetpefile.PeFile">PeFile</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dotnetutils.dotnetpefile.DotNetPeFile.get_processor_bits">
<span class="sig-name descname"><span class="pre">get_processor_bits</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#dotnetutils.dotnetpefile.DotNetPeFile.get_processor_bits" title="Link to this definition">¶</a></dt>
<dd><p>Determines what procesor bits (32 or 64) the .NET Assembly actually runs as.
see dnSpy’s dnSpy.Decompiler.TargetFrameworkUtils.GetArchString</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>0 if an error occurred, otherwise 32 if the file runs on 32-bit and 64 if it runs on 64-bit.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dotnetutils.dotnetpefile.DotNetPeFile.get_product_version">
<span class="sig-name descname"><span class="pre">get_product_version</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#dotnetutils.dotnetpefile.DotNetPeFile.get_product_version" title="Link to this definition">¶</a></dt>
<dd><p>Obtains ProductVersion from the PE’s string table.  Used in some obfuscators for string decryption.
TODO: Remove pefile.PE dependency.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The PE’s ProductVersion string.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dotnetutils.dotnetpefile.DotNetPeFile.get_resource_by_name">
<span class="sig-name descname"><span class="pre">get_resource_by_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dotnetutils.dotnetpefile.DotNetPeFile.get_resource_by_name" title="Link to this definition">¶</a></dt>
<dd><p>Obtain a ManifestResource’s data by name.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The resource data corresponding to name, None if it doesnt exist.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>bytes</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dotnetutils.dotnetpefile.DotNetPeFile.get_resources">
<span class="sig-name descname"><span class="pre">get_resources</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#dotnetutils.dotnetpefile.DotNetPeFile.get_resources" title="Link to this definition">¶</a></dt>
<dd><p>Obtains a list of resources referenced by ManifestResources.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A list containing python representations of all resources in the .NET metadata.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>list[<a class="reference internal" href="dotnetutils.net_structs.html#dotnetutils.net_structs.DotNetResourceSet" title="dotnetutils.net_structs.DotNetResourceSet">net_structs.DotNetResourceSet</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dotnetutils.dotnetpefile.DotNetPeFile.get_strings">
<span class="sig-name descname"><span class="pre">get_strings</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#dotnetutils.dotnetpefile.DotNetPeFile.get_strings" title="Link to this definition">¶</a></dt>
<dd><p>Obtains a list of metadata table strings.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A list containing all strings in the #Strings heap.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>list[bytes]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dotnetutils.dotnetpefile.DotNetPeFile.get_token_value">
<span class="sig-name descname"><span class="pre">get_token_value</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">token</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dotnetutils.dotnetpefile.DotNetPeFile.get_token_value" title="Link to this definition">¶</a></dt>
<dd><p>Obtains a python representation of a metadata token.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>token</strong> (<em>unsigned long</em>) – The metadata token to obtain.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Can either be a RowObject or a bytes object.  A bytes object is only returned if the token maps to the #US heap.  None if not found.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dotnetutils.dotnetpefile.DotNetPeFile.get_type_by_full_name">
<span class="sig-name descname"><span class="pre">get_type_by_full_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">type_full_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dotnetutils.dotnetpefile.DotNetPeFile.get_type_by_full_name" title="Link to this definition">¶</a></dt>
<dd><p>Obtains a TypeDef or TypeRef (TypeDefOrRef) object that corresponds to type_full_name.
The type_full_name must include the namespace.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>type_full_name</strong> (<em>bytes</em>) – The full type name, including namespace, to search for.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list containing all TypeDefOrRef objects that match type_full_name.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list[<a class="reference internal" href="dotnetutils.net_row_objects.html#dotnetutils.net_row_objects.TypeDefOrRef" title="dotnetutils.net_row_objects.TypeDefOrRef">net_row_objects.TypeDefOrRef</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dotnetutils.dotnetpefile.DotNetPeFile.get_typeref_by_full_name">
<span class="sig-name descname"><span class="pre">get_typeref_by_full_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">full_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dotnetutils.dotnetpefile.DotNetPeFile.get_typeref_by_full_name" title="Link to this definition">¶</a></dt>
<dd><p>Obtains a TypeRef by its full name, including namespace.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>full_name</strong> (<em>bytes</em>) – The full name, including namespace, of the TypeRef to search for.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A TypeRef corresponding to full_name, None if not found.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="dotnetutils.net_row_objects.html#dotnetutils.net_row_objects.TypeRef" title="dotnetutils.net_row_objects.TypeRef">net_row_objects.TypeRef</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dotnetutils.dotnetpefile.DotNetPeFile.get_types_by_name">
<span class="sig-name descname"><span class="pre">get_types_by_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">type_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dotnetutils.dotnetpefile.DotNetPeFile.get_types_by_name" title="Link to this definition">¶</a></dt>
<dd><p>Obtains a list of TypeDefs matching type_name</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>type_name</strong> (<em>bytes</em>) – The type name to search for.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list containing all TypeDef objects that match name.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list[<a class="reference internal" href="dotnetutils.net_row_objects.html#dotnetutils.net_row_objects.TypeDef" title="dotnetutils.net_row_objects.TypeDef">net_row_objects.TypeDef</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dotnetutils.dotnetpefile.DotNetPeFile.get_user_string_usages">
<span class="sig-name descname"><span class="pre">get_user_string_usages</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">us_index</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dotnetutils.dotnetpefile.DotNetPeFile.get_user_string_usages" title="Link to this definition">¶</a></dt>
<dd><p>Obtains a list of XREFS for #US at us_index.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>us_index</strong> (<em>unsigned long</em>) – The #US index to obtain references for.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of tuples containing the metadata token and the instruction offset for string references.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list[int, int]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dotnetutils.dotnetpefile.DotNetPeFile.get_user_strings">
<span class="sig-name descname"><span class="pre">get_user_strings</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#dotnetutils.dotnetpefile.DotNetPeFile.get_user_strings" title="Link to this definition">¶</a></dt>
<dd><p>Obtains a list of referenced user strings.  If methods are encrypted, this may return no strings.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A list containing all the items of the #US heap that are referenced by code.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>list[bytes]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dotnetutils.dotnetpefile.DotNetPeFile.has_heap">
<span class="sig-name descname"><span class="pre">has_heap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dotnetutils.dotnetpefile.DotNetPeFile.has_heap" title="Link to this definition">¶</a></dt>
<dd><p>Informs the user whether or not a heap exists within an executable.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>name</strong> (<em>str</em>) – The name of the heap to check.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True if the heap exists, False otherwise.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dotnetutils.dotnetpefile.DotNetPeFile.has_metadata_table">
<span class="sig-name descname"><span class="pre">has_metadata_table</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dotnetutils.dotnetpefile.DotNetPeFile.has_metadata_table" title="Link to this definition">¶</a></dt>
<dd><p>Informs the user whether or not a metadata table name exists in the executable</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>name</strong> (<em>bytes</em>) – The name of the metadata table to check for.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True if the table exists, False otherwise.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dotnetutils.dotnetpefile.DotNetPeFile.has_string">
<span class="sig-name descname"><span class="pre">has_string</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">string</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dotnetutils.dotnetpefile.DotNetPeFile.has_string" title="Link to this definition">¶</a></dt>
<dd><p>Informs the user whether a string exists in the binary.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>string</strong> (<em>bytes</em>) – A UTF-8 encoded string to check for.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True if the string exists within #Strings, False otherwise.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dotnetutils.dotnetpefile.DotNetPeFile.has_user_string">
<span class="sig-name descname"><span class="pre">has_user_string</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">string</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dotnetutils.dotnetpefile.DotNetPeFile.has_user_string" title="Link to this definition">¶</a></dt>
<dd><p>Informs the user whether a user string string exists in the binary.
See DotNetPeFile.get_user_strings() for caveats.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>string</strong> (<em>bytes</em>) – A UTF-16LE encoded string to check for.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True if the string exists within #US, False otherwise.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dotnetutils.dotnetpefile.DotNetPeFile.patch_instruction">
<span class="sig-name descname"><span class="pre">patch_instruction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">method_obj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patch_bytes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">instr_offset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orig_size</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dotnetutils.dotnetpefile.DotNetPeFile.patch_instruction" title="Link to this definition">¶</a></dt>
<dd><p>Patch a method’s code.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>method_obj</strong> (<a class="reference internal" href="dotnetutils.net_row_objects.html#dotnetutils.net_row_objects.MethodDef" title="dotnetutils.net_row_objects.MethodDef"><em>net_row_objects.MethodDef</em></a>) – The method to patch.</p></li>
<li><p><strong>patch_bytes</strong> (<em>bytes</em>) – The bytes to patch in.</p></li>
<li><p><strong>instr_offset</strong> (<em>unsigned long</em>) – The instruction method to start patching at.</p></li>
<li><p><strong>orig_size</strong> (<em>unsigned long</em>) – The original code’s size.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dotnetutils.dotnetpefile.DotNetPeFile.reconstruct_executable">
<span class="sig-name descname"><span class="pre">reconstruct_executable</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#dotnetutils.dotnetpefile.DotNetPeFile.reconstruct_executable" title="Link to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Reconstructs the executable, accounting for any changes to the .NET metadata directory.</dt><dd><p>Heap object changes will call this automatically.  It should be called after any change to the metadata directory.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The fixed up bytes representation of the PE file.  Also obtainable through DotNetPeFile.get_exe_data() once this method is called.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>bytes</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dotnetutils.dotnetpefile.DotNetPeFile.set_entry_point">
<span class="sig-name descname"><span class="pre">set_entry_point</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ep_token</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dotnetutils.dotnetpefile.DotNetPeFile.set_entry_point" title="Link to this definition">¶</a></dt>
<dd><p>Patches the executable to change the entry point to ep_token</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ep_token</strong> (<em>unsigned int</em>) – The new entrypoint’s metadata token.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dotnetutils.dotnetpefile.PeFile">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">PeFile</span></span><a class="headerlink" href="#dotnetutils.dotnetpefile.PeFile" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Small custom PeFile implementation.
Designed to ensure less python dependencies.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="dotnetutils.dotnetpefile.PeFile.__file_data">
<span class="sig-name descname"><span class="pre">__file_data</span></span><a class="headerlink" href="#dotnetutils.dotnetpefile.PeFile.__file_data" title="Link to this definition">¶</a></dt>
<dd><p>Byte representation of the PE file.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bytearray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dotnetutils.dotnetpefile.PeFile.__sections">
<span class="sig-name descname"><span class="pre">__sections</span></span><a class="headerlink" href="#dotnetutils.dotnetpefile.PeFile.__sections" title="Link to this definition">¶</a></dt>
<dd><p>A list of IMAGE_SECTION_HEADER items in python dict format.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list[dict]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dotnetutils.dotnetpefile.PeFile.get_directory_by_idx">
<span class="sig-name descname"><span class="pre">get_directory_by_idx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idx</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dotnetutils.dotnetpefile.PeFile.get_directory_by_idx" title="Link to this definition">¶</a></dt>
<dd><p>Obtain an IMAGE_DATA_DIRECTORY by its index within the PE file’s optional header.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>idx</strong> (<em>unsigned int</em>) – The index of the data directory within the PE Optional header.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A blank data directory if not found, otherwise the data directory at idx.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>IMAGE_DATA_DIRECTORY</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dotnetutils.dotnetpefile.PeFile.get_elfanew">
<span class="sig-name descname"><span class="pre">get_elfanew</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#dotnetutils.dotnetpefile.PeFile.get_elfanew" title="Link to this definition">¶</a></dt>
<dd><p>Obtain the value of IMAGE_DOS_HEADER.e_lfanew.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The value of IMAGE_DOS_HEADER.e_lfanew</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dotnetutils.dotnetpefile.PeFile.get_file_data">
<span class="sig-name descname"><span class="pre">get_file_data</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#dotnetutils.dotnetpefile.PeFile.get_file_data" title="Link to this definition">¶</a></dt>
<dd><p>Obtain a byte representation of the PE file’s data.
:returns: A Byte representation of the PE file’s data.
:rtype: bytes</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dotnetutils.dotnetpefile.PeFile.get_offset_from_rva">
<span class="sig-name descname"><span class="pre">get_offset_from_rva</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rva</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dotnetutils.dotnetpefile.PeFile.get_offset_from_rva" title="Link to this definition">¶</a></dt>
<dd><p>Obtain a PE file offset from a RVA.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>rva</strong> (<em>uint64_t</em>) – The RVA to obtain the offset for.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>&lt;uint64_t&gt;-1 if not found, the file offset for the RVA otherwise.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>uint64_t</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dotnetutils.dotnetpefile.PeFile.get_physical_by_rva">
<span class="sig-name descname"><span class="pre">get_physical_by_rva</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rva</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dotnetutils.dotnetpefile.PeFile.get_physical_by_rva" title="Link to this definition">¶</a></dt>
<dd><p>See PeFile.get_offset_from_rva()</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>rva</strong> (<em>uint64_t</em>) – See PeFile.get_offset_from_rva()</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>See PeFile.get_offset_from_rva()</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>uint64_t</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dotnetutils.dotnetpefile.PeFile.get_rva_from_offset">
<span class="sig-name descname"><span class="pre">get_rva_from_offset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">offset</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dotnetutils.dotnetpefile.PeFile.get_rva_from_offset" title="Link to this definition">¶</a></dt>
<dd><p>Obtain a PE RVA from a file offset.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>rva</strong> (<em>uint64_t</em>) – The file offset to obtain the RVA for.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>&lt;uint64_t&gt;-1 if not found, the file RVA for the file offset otherwise.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>uint64_t</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dotnetutils.dotnetpefile.PeFile.get_sections">
<span class="sig-name descname"><span class="pre">get_sections</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#dotnetutils.dotnetpefile.PeFile.get_sections" title="Link to this definition">¶</a></dt>
<dd><p>Obtain a list of python objects (dicts) representing the sections.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A list of sections represented by python objects.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dotnetutils.dotnetpefile.PeFile.is_64bit">
<span class="sig-name descname"><span class="pre">is_64bit</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#dotnetutils.dotnetpefile.PeFile.is_64bit" title="Link to this definition">¶</a></dt>
<dd><p>Is the PE File 64 bit?</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>True if the PE file is 64-bit, False otherwise.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dotnetutils.dotnetpefile.PeFile.update_va">
<span class="sig-name descname"><span class="pre">update_va</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">va_addr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">difference</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dpe</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_streams</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_reconstruction</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stream_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sec_index</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dotnetutils.dotnetpefile.PeFile.update_va" title="Link to this definition">¶</a></dt>
<dd><p>Anytime you make any changes to the binary that results in the size of the binary being changed, you should call this function before doing so.
It will go through and modify all the VAs in the binary to account for the changes.
At the end of this function, get_exe_data() on the dotnetpe should have the fixed RVAs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>va_addr</strong> (<em>uint64_t</em>) – The va_addr where the changes occur.</p></li>
<li><p><strong>difference</strong> (<em>int</em>) – The difference in the binary once the changes are complete.</p></li>
<li><p><strong>dpe</strong> (<a class="reference internal" href="#dotnetutils.dotnetpefile.DotNetPeFile" title="dotnetutils.dotnetpefile.DotNetPeFile"><em>DotNetPeFile</em></a>) – The dotnetpe instance to modify</p></li>
<li><p><strong>in_streams</strong> (<em>bool</em>) – Whether the changes happen before or within the .NET metadata sections.  This is important because it instructs update_va() to update .NET metadata related sections as well.</p></li>
<li><p><strong>do_reconstruction</strong> (<em>bytes</em>) – Should the executable be reconstructed after VA updating is finished?  This usually should be true when editing streams or code, however if you are adding the data yourself to the binary you will want this to be False.</p></li>
<li><p><strong>stream_name</strong> (<em>bool</em>) – stream name that youre editing, if applicable.  can be None</p></li>
<li><p><strong>sec_index</strong> (<em>int</em>) – index of the section where the data resides.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dotnetutils.dotnetpefile.get_offset_sort_func">
<span class="sig-name descname"><span class="pre">get_offset_sort_func</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dotnetutils.dotnetpefile.get_offset_sort_func" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dotnetutils.dotnetpefile.try_get_dotnetpe">
<span class="sig-name descname"><span class="pre">try_get_dotnetpe</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pe_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">b''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dont_process</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dotnetutils.dotnetpefile.try_get_dotnetpe" title="Link to this definition">¶</a></dt>
<dd><p>Obtains a DotNetPeFile from either a file_path or pe_data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file_path</strong> (<em>str</em>) – The filepath for the PE file.  Optional if pe_data is valid.</p></li>
<li><p><strong>pe_data</strong> (<em>bytes</em>) – the PE’s byte representation.  Optional if file_path is valid.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A DotNetPeFile representing the inputted executable, None if invalid.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#dotnetutils.dotnetpefile.DotNetPeFile" title="dotnetutils.dotnetpefile.DotNetPeFile">dotnetpefile.DotNetPeFile</a></p>
</dd>
</dl>
</dd></dl>

</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">dotnetutils</a></h1>









<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">dotnetutils</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="dotnetutils.html">dotnetutils package</a></li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="modules.html">dotnetutils</a><ul>
  <li><a href="dotnetutils.html">dotnetutils package</a><ul>
      <li>Previous: <a href="dotnetutils.html" title="previous chapter">dotnetutils package</a></li>
      <li>Next: <a href="dotnetutils.net_cil_disas.html" title="next chapter">dotnetutils.net_cil_disas module</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2025, IBM.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.2.3</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
      |
      <a href="../_sources/api/dotnetutils.dotnetpefile.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>