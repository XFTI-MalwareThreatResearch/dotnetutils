<!DOCTYPE html>

<html lang="en" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>dotnetutils.net_deobfuscate &#8212; dotnetutils  documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=5ecbeea2" />
    <link rel="stylesheet" type="text/css" href="../../_static/basic.css?v=b08954a9" />
    <link rel="stylesheet" type="text/css" href="../../_static/alabaster.css?v=27fed22d" />
    <script src="../../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <h1>Source code for dotnetutils.net_deobfuscate</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">dotnetutils</span><span class="w"> </span><span class="kn">import</span> <span class="n">net_deobfuscate_funcs</span><span class="p">,</span> <span class="n">net_exceptions</span><span class="p">,</span> <span class="n">dotnetpefile</span><span class="p">,</span> <span class="n">net_graphing</span>

<div class="viewcode-block" id="main">
<a class="viewcode-back" href="../../api/dotnetutils.net_deobfuscate.html#dotnetutils.net_deobfuscate.main">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">():</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">4</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Usage: net_deobfuscate.py &lt;deob type&gt; &lt;input file&gt; &lt;output file&gt;&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Types:&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;conditional: Removes certain conditional statements that arent needed.&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;names: cleans up type, method names etc.&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;dumbfuncs: Cleans up function calls which only purpose is to call another function.&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="s1">&#39;switch: Deobfuscates switch statements that are meant to obfuscate control flow.  Work In Progress, Not currently implemented.&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;printgraph: Prints a function graph of a fucntion within a exe.&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="s1">&#39;unk_obf_1: a currently unknown obfuscator.  Example hash: e6579d0717d17f39f2024280100c9fffb8be1699ccf14d9c708150c0a54fcedb&#39;</span><span class="p">)</span>
        <span class="n">exit</span><span class="p">()</span>
    <span class="n">deob_type</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">obf_exe</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">output_exe</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">obf_exe</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">infile</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">infile</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">deob_type</span> <span class="o">==</span> <span class="s1">&#39;conditional&#39;</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Attempting to remove useless conditionals&#39;</span><span class="p">)</span>
        <span class="n">new_data</span> <span class="o">=</span> <span class="n">net_deobfuscate_funcs</span><span class="o">.</span><span class="n">remove_useless_conditionals</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">deob_type</span> <span class="o">==</span> <span class="s1">&#39;names&#39;</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Cleaning up various names throughout the binary.&#39;</span><span class="p">)</span>
        <span class="n">new_data</span> <span class="o">=</span> <span class="n">net_deobfuscate_funcs</span><span class="o">.</span><span class="n">cleanup_names</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">deob_type</span> <span class="o">==</span> <span class="s1">&#39;dumbfuncs&#39;</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Cleaning up useless function calls&#39;</span><span class="p">)</span>
        <span class="n">new_data</span> <span class="o">=</span> <span class="n">net_deobfuscate_funcs</span><span class="o">.</span><span class="n">remove_useless_functions</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">deob_type</span> <span class="o">==</span> <span class="s1">&#39;switch&#39;</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Removing switch statements with constant outcomes.&#39;</span><span class="p">)</span>
        <span class="c1"># new_data = deobfuscate_method_control_flow(data)</span>
        <span class="k">raise</span> <span class="n">net_exceptions</span><span class="o">.</span><span class="n">OperationNotSupportedException</span><span class="p">()</span>
    <span class="k">elif</span> <span class="n">deob_type</span> <span class="o">==</span> <span class="s1">&#39;printgraph&#39;</span><span class="p">:</span>
        <span class="n">method_rid</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">output_exe</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Printing graph for method </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">method_rid</span><span class="p">))</span>
        <span class="n">dpe</span> <span class="o">=</span> <span class="n">dotnetpefile</span><span class="o">.</span><span class="n">DotNetPeFile</span><span class="p">(</span><span class="n">pe_data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
        <span class="n">mobj</span> <span class="o">=</span> <span class="n">dpe</span><span class="o">.</span><span class="n">get_method_by_rid</span><span class="p">(</span><span class="n">method_rid</span><span class="p">)</span>
        <span class="n">fgraph</span> <span class="o">=</span> <span class="n">net_graphing</span><span class="o">.</span><span class="n">FunctionGraph</span><span class="p">(</span><span class="n">mobj</span><span class="p">)</span>
        <span class="n">fgraph</span><span class="o">.</span><span class="n">print_root</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;done&#39;</span><span class="p">)</span>
        <span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">deob_type</span> <span class="o">==</span> <span class="s1">&#39;unk_obf_1&#39;</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Attempting to remove obfuscation using unk_obf_1.&#39;</span><span class="p">)</span>
        <span class="n">new_data</span> <span class="o">=</span> <span class="n">net_deobfuscate_funcs</span><span class="o">.</span><span class="n">remove_useless_bytearray_conditionals</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">new_data</span> <span class="o">=</span> <span class="n">net_deobfuscate_funcs</span><span class="o">.</span><span class="n">cleanup_names</span><span class="p">(</span><span class="n">new_data</span><span class="p">)</span>
        <span class="n">new_data</span> <span class="o">=</span> <span class="n">net_deobfuscate_funcs</span><span class="o">.</span><span class="n">remove_unk_obf_1_obfuscation</span><span class="p">(</span><span class="n">new_data</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;invalid mode&#39;</span><span class="p">)</span>
        <span class="n">exit</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">new_data</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">output_exe</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">outfile</span><span class="p">:</span>
            <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">new_data</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Done&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error deobfuscating: returned None.&#39;</span><span class="p">)</span></div>



<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>

          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../index.html">dotnetutils</a></h1>









<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../api/modules.html">dotnetutils</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="../index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2025, IBM.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.2.3</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
    </div>

    

    
  </body>
</html>